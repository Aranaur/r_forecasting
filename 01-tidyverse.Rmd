# Вступ у Tidyverse {#tidy_verse}
***
```{r echo = FALSE, purl = FALSE, cache = FALSE, include=FALSE}
knitr::opts_knit$set(global.par = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, collapse = TRUE, out.width = '100%', fig.align='center')
library(tidyverse)
library(vroom)
library(gapminder)
library(readxl)
```
##  Tidy-всесвіт {#tidy}
***
[**Tidyverse**](https://www.tidyverse.org/) --- це екосистема, набір пакетів, які спеціально створені для науки про дані (data science). В ньому є ключові пакети (ядро tidyverse) та побічні --- які додатково розширюють можливості мови програмування R.

**Концепція охайних даних (tidy-data)** передбачає приведення даних до формату, в якому:

- Кожна змінна міститься в окремому стовпчику

- Кожне спостереження міститься в окремому рядку

- Кожне значення міститься в окремій комірці

**Ядро tidyverse:**

- **ggplot2**, для візуалізації

- **dplyr**, для маніпуляції з даними

- **tidyr**, для отримання охайних даних (tidy data)

- **readr**, для зчитування та записування файлів в R

- **purrr**, для функціонального програмування

- **tibble**, для роботи з тібблами (tibble), просунутий варіант дата фреймів

- **stringr**, для роботи з текстовими даними

- **forcats**, для роботи з факторами (factors)

Крім того є ще низка допоміжних пакетів, які не входять до ядра tidyverse але вважаються його частиною:

- **vroom**, для швидкого завантаження даних

- **DBI**, для роботи з базами даних

- **haven**, для даних SPSS, Stata та SAS

- **httr**, для роботи з API

- **readxl** для завантаження .xls та .xlsx файлів

- **googlesheets4**, для роботи з Google Sheet

- **googledrive**, для роботи з Google Drive

- **rvest**, для скрапінгу веб-сторінок

- **jsonlite**, для роботи з JSON-файлами

- **xml2**, для роботи з XML

- **lubridate**, для роботи з датами

- **dbplyr**, для перетворення коду `dplyr` в SQL

- **dtplyr**, для перетворення коду на `data.table`

- **magrittr**, для використання конвеєрів `%>%` (pipe)

- **glue**, для поєднання даних та тексту

- **tidymodels**, для роботи з моделями манинного навчання.

І це ще не повний список. Крім офіційних пакетів tidyverse є ще низка пакетів, які намагаються відповідати принципам tidyverse і доповнюють його.

Для завантаження tidyverse необхідно виконати наступний код:
```{r eval=FALSE}
install.packages("tidyverse")
```
Для підключення:
```{r eval=FALSE}
library("tidyverse")
```

## Завантаження даних {#tidy_read}
***
### Завантаження .csv, .tsv файлів {#tidy_csv}
Стандартною функцією завантаження даних типу `.csv` є функція `read.csv()`, але на досить великих масивах даних краще використовувати `read_csv()` з пакету `readr`. Синтаксис цих функцій схожий, але `read_csv()` одразу приведе дані до формату `tibble`.
Першим аргументом функції є шлях до файлу (зі оберненим слешем `/`), в тому числі URL-посилання: 
```{r eval=FALSE}
read_file <- read_csv("docs/data/file.csv")
read_url <- read_csv("https://git.io/JztOr")
```

Аналогічно до `read_csv()` можна використовувати функцію `vroom` з однойменного пакету. Головною особливістю цього пакету є [швидкість завантаження даних](https://cran.r-project.org/web/packages/vroom/vignettes/benchmarks.html).
```{r eval=FALSE}
vroom_file <- vroom("docs/data/file.csv")
vroom_url <- vroom("https://git.io/JztOr")
```

Для **завантаження** одночасно **декількох файлів однакової структури** корисно використовувати наступну конструкцію
```{r eval=FALSE}
filse <- dir(pattern = "\\.csv$")
vroom_all <- vroom(filse)
```

### Завантаження .xls, .xlsx файлів {#tidy_xls}
Для завантаження файлів **Excel** використовується пакет `readxl` та функція `read_excel()`.
На початку можна отримати перелік листів файлу Excel за допомогою функції `excel_sheets()`
```{r}
readxl::excel_sheets("docs/data/tourism.xlsx")
```
Після чого зчитати данні з потрібного листа
```{r eval=FALSE}
excel_file <- read_excel("docs/data/tourism.xlsx", sheet = "Sheet1")
```

В більшості випадків цього інструментарію має бути достатньо, але для завантаження специфічних файлів завжди можна знайти потрібний пакет. Не соромтеся використовувати google.


## Маніпуляції з даними за допомогою пакету `dplyr` {#tidy_dplyr}
***
`dplyr` --- це один з найголовніших пакетів `tidyverse`. Головний його функціонал --- це різноманітні маніпуляції з даними:

- фільтрація даних --- `filter()`

- впорядкування даних --- `arrange()`

- вибір змінних --- `select()`

- створення нових змінних --- `mutate()`

- групування даних --- `group_by`

- агрегування даних --- `summarize()`

### Фільтрація рядків з допомогою функції `filter()` {#tidy_filter}
Перш за все підключимо необхідні пакети:
```{r eval=FALSE}
library(gapminder)
library(dplyr)
```
Розберемо на прикладі датасету `gapmainder` з однойменного пакету (див. таб. \@ref(tab:gapminder)). В ньому збережена інформація про ВВП, очікувану тривалість життя при народженні та населення для 142 країн світу з 1952 по 2007 роки.
```{r gapminder, echo=FALSE}
gapminder %>% 
  head() %>% 
  knitr::kable(caption = "Перші шість значень датасету gapminder")
```




## Створення звітів: R Markdown {#r_mark}
***
